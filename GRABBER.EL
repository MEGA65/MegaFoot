' «RABBER ‘OOL - PORTED TO ≈LEVEN (FOR EASIER MAINTENANCE)' ------------'' ’SAGE:' -----' - –RESS 'SPACE' KEY ON TOP-LEFT POINT' - ‘HEN USE CURSOR KEYS TO MOVE TO BOTTOM-RIGHT POINT & PRESS 'SPACE'' - –RESS '-' AND '+' KEYS TO MOVE BETWEEN PREVIOUS AND NEXT FRAMES' - –RESS 'C' TO REDRAW CURRENT FRAME' - –RESS 'L' THEN A FRAME# TO LOAD THAT FRAME' - –RESS 'X' TO EXIT PROGRAM#OUTPUT "GRABBER"'--------.DECLARES'--------#DECLARE CLRØLINEØRIGHT$ = CHR$(27)+"Q"   ' OLD CL$#DECLARE CURRENTØFRAME  ' OLD FF#DECLARE X, Y  ' CURSOR POSITION#DECLARE PTR  ' POINTER TO DATA BYTES IN MEMORY#DECLARE FRAMEØCOUNT#DECLARE FRMIDX#DECLARE BYTESØUSED  ' OLD L#DECLARE W, H#DECLARE STARTØCHAR, STARTØCOLOR, ENDØCHAR, ENDØCOLOR#DECLARE STARTX, STARTY, ENDX, ENDY#DECLARE CURRØFRAME#DECLARE CLRØPTR#DECLARE A$, XIDX, YIDX#DECLARE DESTØCHARØPTR, DESTØCLRØPTR#DEFINE ”‘œ“≈Ø”‘¡“‘Ø–œ” = 0#DEFINE ”‘œ“≈Ø≈ŒƒØ–œ” = 1#DECLARE STOREØSTATE  ' ARE WE STORING START/END POS CHAR/COLOUR DETAILS'----.MAIN'----  POKE $D020, 11, 14  GOSUB INITØVARS  GOSUB CHECKØMAGICØSIGNATURE  GOSUB LOCATEØNEXTØFREEØBYTE  GOSUB DRAWØFOOTER  DO WHILE 1    GOSUB STOREØSTATEØINFO    GOSUB DRAWØCURSOR    GOSUB READØINPUT    GOSUB SHOWØCOORDS  LOOP'-----------.SHOWØCOORDS'-----------  CURSOR 0, 49  PRINT CLRØLINEØRIGHT$;  IF STOREØSTATE = ”‘œ“≈Ø”‘¡“‘Ø–œ” THEN BEGIN    PRINT CHR$(27)+"QX=";X;", Y=";Y;  BEND  IF STOREØSTATE = ”‘œ“≈Ø≈ŒƒØ–œ” THEN BEGIN    PRINT CHR$(27)+"QX=";STARTX;", Y=";STARTY;    PRINT ", W=";X-STARTX+1;", H=";Y-STARTY+1;  BEND  PRINT CLRØLINEØRIGHT$;  RETURN'----------.READØINPUT'----------  GETKEY A$  IF A$ <> " " THEN GOSUB RESTOREØCHARØUNDERØCURSOR  IF A$ = "ù" AND X > 0 THEN X = X - 1  IF A$ = "" AND X < 79 THEN X = X + 1  IF A$ = "ë" AND Y > 0 THEN Y = Y - 1  IF A$ = "" AND Y < 49 THEN Y = Y + 1  IF A$ = "C" THEN BEGIN    PRINT "ì";    CURRØFRAME = 0    GOSUB DRAWØCURRØFRAME  BEND  IF A$="-" AND CURRØFRAME > 0 THEN BEGIN    CURRØFRAME = CURRØFRAME - 1    GOSUB DRAWØCURRØFRAME  BEND  IF A$="=" AND CURRØFRAME < PEEK($42000)-1 THEN BEGIN    CURRØFRAME = CURRØFRAME + 1    GOSUB DRAWØCURRØFRAME  BEND  IF A$=" " THEN BEGIN    STOREØSTATE = STOREØSTATE + 1    IF STOREØSTATE = 2 THEN BEGIN      GOSUB SAVEØFRAMEØTOØMEMORY      END    BEND  BEND  IF A$="L" THEN GOSUB LOADØFRAME  IF A$="X" THEN BEGIN    CURSOR 0,0    END  BEND  RETURN'--------------------.SAVEØFRAMEØTOØMEMORY'--------------------  POKE $40800 + STARTX + STARTY * 80, STARTØCHAR  POKE $FF80000 + STARTX + STARTY * 80, STARTØCOLOR  POKE $40800 + ENDX + ENDY * 80, ENDØCHAR  POKE $FF80000 + ENDX + ENDY * 80, ENDØCOLOR  FRAMEØCOUNT = PEEK($42000)  GOSUB LOCATEØNEXTØFREEØBYTE  PTR = $42000 + BYTESØUSED  POKE PTR, STARTX  PTR = PTR + 1  POKE PTR, STARTY  PTR = PTR + 1  POKE PTR, X - STARTX + 1  PTR = PTR + 1  POKE PTR, Y - STARTY + 1  PTR = PTR + 1  FOR YIDX = STARTY TO Y    FOR XIDX = STARTX TO X     POKE PTR, PEEK($40800 + XIDX + YIDX * 80)     PTR = PTR + 1    NEXT XIDX  NEXT YIDX  FOR YIDX = STARTY TO Y    FOR XIDX = STARTX TO X     POKE PTR, PEEK($FF80000 + XIDX + YIDX * 80)     PTR = PTR + 1    NEXT XIDX  NEXT YIDX  POKE $42000, FRAMEØCOUNT + 1  CURSOR 0,49  PRINT CLRØLINEØRIGHT$;"FRAME COUNT=";PEEK($42000);  PRINT ", NEXT-FREE=$";HEX$(PTR);  CURSOR 0,0  RETURN'----------.LOADØFRAME'----------  PRINT "";CLRØLINEØRIGHT$;  INPUT "FRAME#";CURRØFRAME  GOSUB DRAWØCURRØFRAME  RETURN'---------------.DRAWØCURRØFRAME'---------------  FRAMEØCOUNT = PEEK($42000)  PTR = $42001  FRMIDX = 0  IF FRMIDX >= FRAMEØCOUNT THEN BEGIN    CURSOR 0,0    PRINT CLRØLINEØRIGHT$;"INVALID BLOCK#!"    RETURN  BEND  ' TRAVERSE TO FIND BLOCK  DO WHILE 1    IF FRMIDX = CURRØFRAME THEN GOTO ØFOUNDØIT    ' SKIP X, Y    PTR = PTR + 2    W = PEEK(PTR)    PTR = PTR + 1    H = PEEK(PTR)    PTR = PTR + 1    PTR = PTR + W * H * 2    FRMIDX = FRMIDX + 1  LOOP  .ØFOUNDØIT  X = PEEK(PTR)  PTR = PTR + 1  Y = PEEK(PTR)  PTR = PTR + 1  W = PEEK(PTR)  PTR = PTR + 1  H = PEEK(PTR)  PTR = PTR + 1  ENDX = X + W - 1  ENDY = Y + H - 1  PRINT "";CLRØLINEØRIGHT$;  PRINT "X=";X;", Y=";Y;", W=";W;", H=";H;  PRINT ", PTR=$";HEX$(PTR);  PRINT "";CHR$(27);"J";CLRØLINEØRIGHT$;"FRAME=";CURRØFRAME;  PRINT ", NXT=$";HEX$(PTR + W * H * 2);  CLRØPTR = PTR + W * H  DESTØCHARØPTR =$40800 + X + Y * 80  DESTØCLRØPTR = $FF80000 + X + Y * 80  FOR YIDX = Y TO ENDY    EDMA 0, W, PTR, DESTØCHARØPTR    EDMA 0, W, CLRØPTR, DESTØCLRØPTR    PTR = PTR + W    CLRØPTR = CLRØPTR + W    DESTØCHARØPTR = DESTØCHARØPTR + 80    DESTØCLRØPTR = DESTØCLRØPTR + 80  NEXT YIDX  RETURN'-------------------------.RESTOREØCHARØUNDERØCURSOR'-------------------------  IF STOREØSTATE = ”‘œ“≈Ø”‘¡“‘Ø–œ” THEN BEGIN    POKE $40800 + X + Y * 80, STARTØCHAR    POKE $FF80000 + X + Y * 80, STARTØCOLOR  BEND:ELSE BEGIN  ' ”‘œ“≈Ø≈ŒƒØ–œ”    POKE $40800 + X + Y * 80, ENDØCHAR    POKE $FF80000 + X + Y * 80, ENDØCOLOR        BEND  RETURN'-----------.DRAWØCURSOR'-----------  POKE $40800 + X + Y * 80, 43  POKE $FF80000 + X + Y * 80, 1  RETURN'-----------.DRAWØFOOTER'-----------  CURSOR 0,49  PRINT CLRØLINEØRIGHT$;"FRAME COUNT=";PEEK($42000);", NEXT-FREE=$";  PRINT HEX$(PTR);  RETURN'----------------.STOREØSTATEØINFO'----------------  IF STOREØSTATE = ”‘œ“≈Ø”‘¡“‘Ø–œ” THEN BEGIN    STARTØCHAR = PEEK($40800 + X + Y * 80)    STARTØCOLOR = PEEK($FF80000 + X + Y * 80)    STARTX = X    STARTY = Y  BEND:ELSE BEGIN ' ”‘œ“≈Ø≈ŒƒØ–œ”    ENDØCHAR = PEEK($40800 + X + Y * 80)    ENDØCOLOR = PEEK($FF80000 + X + Y * 80)    ENDX = X    ENDY = Y  BEND  RETURN'---------.INITØVARS'---------  CURRENTØFRAME = 0  STOREØSTATE = ”‘œ“≈Ø”‘¡“‘Ø–œ”  X = 0  Y = 0  CURRØFRAME = 0  RETURN  '---------------------.LOCATEØNEXTØFREEØBYTE'---------------------  FRAMEØCOUNT = PEEK($42000)  PTR = $42001  FRMIDX = 0  DO WHILE 1    IF FRMIDX = FRAMEØCOUNT THEN BEGIN      BYTESØUSED = PTR-$42000      RETURN    BEND    PTR = PTR + 2  ' SKIP X, Y INFO    W = PEEK(PTR) : PTR = PTR + 1    H = PEEK(PTR) : PTR = PTR + 1    PTR = PTR + W * H * 2    FRMIDX = FRMIDX + 1  LOOP  RETURN'---------------------.CHECKØMAGICØSIGNATURE'---------------------  IF PEEK($5FFFE) <> 71 OR PEEK($5FFFF) <> 73 THEN BEGIN    WPOKE $5FFFE, $4947    PRINT "ì";CLRØLINEØRIGHT$;    PRINT "MAGIC SIGNATURE APPLIED. “ESET FRAME COUNT TO ZERO? (Ÿ/Œ)";    GET KEY A$    IF A$ = "Y" THEN POKE $42000,0    PRINT "ì";CLRØLINEØRIGHT$;  BEND  RETURN