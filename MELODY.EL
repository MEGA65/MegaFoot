#OUTPUT PLAYMAKER' ÀEYS:' ----'    ’P ARROW = ÕOVE TO PREVIOUS VOICE'  ƒOWN ARROW = ÕOVE TO NEXT VOICE'  ÃEFT ARROW = ÕOVE LEFT WITHIN CURRRENT VOIE STRING' “IGHT ARROW = ÕOVE RIGHT WITHIN CURRENT VOIE STRING'    …Œ”‘/ƒ≈Ã = ƒELETE CHAR IN CURRENT VOICE STRING'       ≈”√,  = ÕOVE TO START OF CURRENT VOICE STRING'       ≈”√,À = ÕOVE TO END OF CURRENT VOICE STRING'      √‘“Ã+◊ = ÕOVE FORWARD ONE WORD IN CURRENT VOICE STRING'      √‘“Ã+’ = ÕOVE BACK ONE WORD IN CURRENT VOICE STRING'           < = ”HOW PREVIOUS SONG CHUNK'           > = ”HOW NEXT SONG CHUNK'           - = ƒECREASE TEMPO'           + = …NCREASE TEMPO'      Õ≈«¡+— = —UIT PROGRAM / ≈XIT ≈NV ≈DITOR'          ∆1 = ÃOAD'          ∆3 = ”AVE'          ∆7 = ≈NVELOPE EDITOR'          ∆8 = ∆ILTER EDITOR'   ∆9/√‘“Ã-– = √HUNK SEQUENCERTRAP RUNSTOPØTRAPPER.DECLARATIONS'------------#DECLARE CHUNKØIDX = 0#DECLARE CHUNKØCNT = 0#DEFINE CHUNKØMAX = 50#DECLARE VIDX, IDX#DECLARE CURSORØX = 0#DECLARE CURSORØY = 0#DECLARE V$(5,CHUNKØMAX)#DECLARE KEY$#DECLARE VALID$="CDEFGAB0123456789 #$.HIQRSWOTUXMPL"#DECLARE VAL$#DECLARE TMPO% = 12#DECLARE ESCØFLAG% = 0#STRUCT ≈Œ÷‘Ÿ–≈ NAME$, ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PW≈Œ÷‘Ÿ–≈ ENVS(9) = [ _  [ "–IANO",       0,  9,  0,  0,  2, 1536 ], _  [ "¡CCORDION",  12,  0, 12,  0,  1,    0 ], _  [ "√ALLIOPE",    0,  0, 15,  0,  0,    0 ], _  [ "ƒRUM",        0,  5,  5,  0,  3,    0 ], _  [ "∆LUTE",       9,  4,  4,  0,  0,    0 ], _  [ "«UITAR",      0,  9,  2,  1,  1,    0 ], _  [ "»ARPSICRD",   0,  9,  0,  0,  2,  512 ], _  [ "œRGAN",       0,  9,  9,  0,  2, 2048 ], _  [ "‘RUMPET",     8,  9,  4,  1,  2,  512 ], _  [ "ÿYLOPHONE",   0,  9,  0,  0,  0,    0 ]  _]#DEFINE ƒ…“ØŒœŒ≈ = 0#DEFINE ƒ…“Ø’–   = 1#DEFINE ƒ…“Øƒœ◊Œ = 2#DEFINE ƒ…“Øœ”√  = 3#DECLARE DIRØNAME$(3)DIRØNAME$(0) = "ŒœŒ≈"DIRØNAME$(1) = "’–"DIRØNAME$(2) = "ƒœ◊Œ"DIRØNAME$(3) = "œ”√"#DEFINE ∆Øœ∆∆ = 0#DEFINE ∆ØœŒ  = 1#STRUCT ∆…Ã‘‘Ÿ–≈ NAME$, FREQ, LP, BP, HP, RES, DIR, MIN, SWEEP∆…Ã‘‘Ÿ–≈ FILT(10) = [ _  [ "LOWPØUP",    1000, ∆ØœŒ,  ∆Øœ∆∆, ∆Øœ∆∆, 15, ƒ…“Ø’–,   100, 10 ], _  [ "LOWPØDOWN",  1000, ∆ØœŒ,  ∆Øœ∆∆, ∆Øœ∆∆, 15, ƒ…“Øƒœ◊Œ, 100, 10 ], _  [ "LOWPØOSC",   1000, ∆ØœŒ,  ∆Øœ∆∆, ∆Øœ∆∆, 15, ƒ…“Øœ”√,  100, 10 ], __  [ "BANDPØUP",   1000, ∆Øœ∆∆, ∆ØœŒ,  ∆Øœ∆∆, 15, ƒ…“Ø’–,   100, 10 ], _  [ "BANDPØDOWN", 1000, ∆Øœ∆∆, ∆ØœŒ,  ∆Øœ∆∆, 15, ƒ…“Øƒœ◊Œ, 100, 10 ], _  [ "BANDPØOSC",  1000, ∆Øœ∆∆, ∆ØœŒ,  ∆Øœ∆∆, 15, ƒ…“Øœ”√,  100, 10 ], __  [ "HIGHPØUP",   1000, ∆Øœ∆∆, ∆Øœ∆∆, ∆ØœŒ,  15, ƒ…“Ø’–,   100, 10 ], _  [ "HIGHPØDOWN", 1000, ∆Øœ∆∆, ∆Øœ∆∆, ∆ØœŒ,  15, ƒ…“Øƒœ◊Œ, 100, 10 ], _  [ "HIGHPØOSC",  1000, ∆Øœ∆∆, ∆Øœ∆∆, ∆ØœŒ,  15, ƒ…“Øœ”√,  100, 10 ], __  [ "SPAREØ1",    0,    ∆Øœ∆∆, ∆Øœ∆∆, ∆Øœ∆∆, 0,  ƒ…“ØŒœŒ≈, 0,   0  ], _  [ "SPAREØ2",    0,    ∆Øœ∆∆, ∆Øœ∆∆, ∆Øœ∆∆, 0,  ƒ…“ØŒœŒ≈, 0,   0  ], __]#DECLARE SEQØCHUNK(100), SEQØEXTRA(100)#DECLARE ECHOØM, ECHOØB, ECHOØSZ = .05, CHUNKØRPT#DECLARE V1$, V2$, V3$, V4$, V5$, V6$.CMDS#DEFINE √ÕƒØ‘≈Õ–œ = -1#DEFINE √ÕƒØ∆…Ã‘≈“ = -2#DEFINE √ÕƒØÃœœ– = -3#DEFINE √ÕƒØ≈√»œØÕ1 = -4   ' ECHO MELODY: VOICE 1 ON VOICE 4#DEFINE √ÕƒØ≈√»œØÕ2 = -5   ' ECHO MELODY: VOICE 1 ON VOICE 2 + 4 + 5#DEFINE √ÕƒØ≈√»œØ¬  = -6   ' ECHO BASS:   VOICE 3 ON VOICE 6#DEFINE √ÕƒØ≈√»œØœ∆∆ = -7#DEFINE √ÕƒØ≈√»œØ”⁄ = -8#DEFINE √ÕƒØÕ¡ÿ = 9#DECLARE SEQØCMDNAME$(10)SEQØCMDNAME$(1) = "‘≈Õ–œ"SEQØCMDNAME$(2) = "∆…Ã‘≈“"SEQØCMDNAME$(3) = "Ãœœ–"SEQØCMDNAME$(4) = "≈√»œØÕ1"SEQØCMDNAME$(5) = "≈√»œØÕ2"SEQØCMDNAME$(6) = "≈√»œØ¬"SEQØCMDNAME$(7) = "≈√»œØœ∆∆"SEQØCMDNAME$(8) = "≈√»œØ”⁄"#DECLARE SEQCNT, SEQPTR#DECLARE ROW, COL, SROW, SCOL, A$, V, MAXV, V$#STRUCT À≈ŸØ‘Ÿ–≈ IN$, OUT$À≈ŸØ‘Ÿ–≈ KEYS(11) = [ _  [ "A", "C", ], _  [ "W", "#C", ], _  [ "S", "D", ], _  [ "E", "#D", ], _  [ "D", "E", ], _  [ "F", "F", ], _  [ "T", "#F", ], _  [ "G", "G", ], _  [ "Y", "#G", ], _  [ "H", "A", ], _  [ "U", "#A", ], _  [ "J", "B", ] _]#DECLARE PSTR$, K, DELTA#DECLARE WNAME$(4)WNAME$(0) = "‘“…"WNAME$(1) = "”¡◊"WNAME$(2) = "–’Ã”≈"WNAME$(3) = "Œœ…”≈"WNAME$(4) = "“…Œ«"#DECLARE FILTØSTATEØNAME$(2)FILTØSTATEØNAME$(0) = "œ∆∆"FILTØSTATEØNAME$(1) = "œŒ"#DECLARE FPRESET = 1#DECLARE FSCOL = 0, FSROW = 0, FFOCUS = 0, FSEL = -1#DECLARE OCT = 5#DECLARE CURRØFREQ, CURRØDIR#DECLARE HANDLED#DECLARE PLYPTR = -1, PLYFLAG.DURATION'--------#DEFINE ƒŒ¡Õ≈ = 0#DEFINE ƒ√»¡“ = 1#DEFINE ƒÀ≈Ÿ  = 2#DEFINE ƒØ◊»œÃ≈ = 0#DEFINE ƒØ»¡Ã∆ = 1#DEFINE ƒØ—’¡“‘≈“ = 2#DEFINE ƒØ≈…«»‘» = 3#DEFINE ƒØ”…ÿ‘≈≈Œ‘» = 4#DECLARE SDUR = 2#DECLARE DUR$(5,2)DUR$(ƒØ◊»œÃ≈, ƒŒ¡Õ≈) = "WHOLE"DUR$(ƒØ◊»œÃ≈, ƒ√»¡“) = "W"DUR$(ƒØ◊»œÃ≈, ƒÀ≈Ÿ)  = "1"DUR$(ƒØ»¡Ã∆, ƒŒ¡Õ≈) = "HALF"DUR$(ƒØ»¡Ã∆, ƒ√»¡“) = "H"DUR$(ƒØ»¡Ã∆, ƒÀ≈Ÿ)  = "2"DUR$(ƒØ—’¡“‘≈“, ƒŒ¡Õ≈) = "QUARTER"DUR$(ƒØ—’¡“‘≈“, ƒ√»¡“) = "Q"DUR$(ƒØ—’¡“‘≈“, ƒÀ≈Ÿ)  = "3"DUR$(ƒØ≈…«»‘», ƒŒ¡Õ≈) = "EIGHTH"DUR$(ƒØ≈…«»‘», ƒ√»¡“) = "I"DUR$(ƒØ≈…«»‘», ƒÀ≈Ÿ)  = "4"DUR$(ƒØ”…ÿ‘≈≈Œ‘», ƒŒ¡Õ≈) = "SIXTEENTH"DUR$(ƒØ”…ÿ‘≈≈Œ‘», ƒ√»¡“) = "S"DUR$(ƒØ”…ÿ‘≈≈Œ‘», ƒÀ≈Ÿ)  = "5".KEYS'----#DEFINE À≈ŸØ’– = "ë"#DEFINE À≈ŸØƒœ◊Œ = ""#DEFINE À≈ŸØÃ≈∆‘ = "ù"#DEFINE À≈ŸØ“…«»‘ = ""#DEFINE À≈ŸØ”–¡√≈ = " "#DEFINE À≈ŸØƒ≈Ã = ""#DEFINE À≈ŸØ√‘“ÃØ◊ = ""#DEFINE À≈ŸØ√‘“ÃØ’ = ""#DEFINE À≈ŸØÕ≈«¡Ø— = "´"#DEFINE À≈ŸØ∆1 = "Ö"#DEFINE À≈ŸØ∆3 = "Ü"#DEFINE À≈ŸØ∆4 = "ä"#DEFINE À≈ŸØ∆7 = "à"#DEFINE À≈ŸØ∆8 = "å"#DEFINE À≈ŸØ∆9 = CHR$(16)#DEFINE À≈ŸØ“≈‘’“Œ = CHR$(13)#DEFINE À≈ŸØ≈”√¡–≈ = CHR$(27)#DEFINE À≈ŸØ”»…∆‘Ø“≈‘’“Œ = CHR$(141)#DEFINE À≈ŸØ”»…∆‘Ø–Ã’” = "€"#DEFINE À≈ŸØ”»…∆‘ØÕ…Œ’” = "›"#DEFINE À≈ŸØ“≈÷ØœŒ = ""#DEFINE À≈ŸØ“≈÷Øœ∆∆ = "í"#DEFINE À≈ŸØ‘¡¬ = CHR$(9)#DEFINE À≈ŸØ»œÕ≈ = ""#DEFINE À≈ŸØ√Ã“  = "ì"#DEFINE À≈ŸØÃœ◊≈“√¡”≈ = CHR$(14)#DEFINE À≈ŸØ’––≈“√¡”≈ = CHR$(142).INIT'----PRINT "ì";À≈ŸØÃœ◊≈“√¡”≈;À≈ŸØ≈”√¡–≈;"5";PLAY : PLAY "".MAIN'----  KEY OFF  GOSUB DRAWØEDITORØSCREEN  GOSUB USERØINPUT  GOTO MAIN.DRAWØEDITORØSCREEN'------------------  CURSOR 0,0:PRINT "ìPLAYMAKER V0.5 - BY GURCE ISIKYILDIZ"  PRINT "---------"  PRINT "<: PREV CHUNK, >: NEXT CHUNK, -/+ TEMPO, ∆7=ENV EDITOR, ∆9/√‘“Ã-–=SEQ EDITOR"  PRINT "“‘Œ: PLAY CURR VOICE, ”»∆‘+“‘Œ: PLAY ALL VOICE, ∆1=LOAD, ∆3=SAVE, Õ≈«¡+—=QUIT"  PRINT  GOSUB DRAWØCURRENTØCHUNK  RETURN.DRAWØCURRENTØCHUNK'------------------  PRINT "TEMPO: "; TMPO%  PRINT "CHUNKØIDX: "; CHUNKØIDX       FOR VIDX=0 TO 5    IF CURSORØY <> VIDX THEN BEGIN      CURSOR 0,9+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX+1;": ";V$(VIDX,CHUNKØIDX);    BEND:ELSE BEGIN      CURSOR 0,9+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX+1;": ";      FOR IDX=1 TO LEN(V$(VIDX,CHUNKØIDX))        IF CURSORØX = IDX-1 THEN BEGIN          PRINT "";MID$(V$(VIDX,CHUNKØIDX),IDX,1);"í";        BEND:ELSE BEGIN          PRINT MID$(V$(VIDX,CHUNKØIDX),IDX,1);        BEND      NEXT IDX      IF LEN(V$(VIDX,CHUNKØIDX)) = 0 OR CURSORØX=LEN(V$(VIDX,CHUNKØIDX)) THEN PRINT " í";    BEND  NEXT VIDX  RETURN.CHECKØVALIDØKEY'---------------  FOR IDX=1 TO LEN(VALID$)    VAL$=MID$(VALID$,IDX,1)    IF KEY$= VAL$ THEN BEGIN      IF CURSORØX < LEN(V$(CURSORØY,CHUNKØIDX)) THEN BEGIN        V$(CURSORØY,CHUNKØIDX) = LEFT$(V$(CURSORØY,CHUNKØIDX),CURSORØX) _          + VAL$ + MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1)        CURSORØX=CURSORØX+1        RETURN      BEND      V$(CURSORØY,CHUNKØIDX)=V$(CURSORØY,CHUNKØIDX)+VAL$      CURSORØX=CURSORØX+1      RETURN    BEND  NEXT IDX  RETURN.FORWARDØWORD'------------  IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) <> " "    CURSORØX=CURSORØX+1    IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  LOOP  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) = " "    CURSORØX=CURSORØX+1    IF CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX)) THEN RETURN  LOOP  RETURN.PREVIOUSØWORD'-------------  IF CURSORØX = 0 THEN RETURN  IF CURSORØX = 1 THEN CURSORØX = 0: RETURN  CURSORØX = CURSORØX - 1  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) = " "    CURSORØX=CURSORØX-1    IF CURSORØX = 0 THEN RETURN  LOOP  DO WHILE MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1,1) <> " "    CURSORØX=CURSORØX-1    IF CURSORØX = 0 THEN RETURN  LOOP  CURSORØX=CURSORØX+1  RETURN.SETØALLØENV'-----------  FOR ROW = 0 TO 9    GOSUB SETØENV  NEXT ROW  RETURN.LOAD'----  INPUT "LOAD NAME: ";KEY$  IF KEY$="" THEN RETURN  DOPEN #2,(KEY$),R,U8  ' LOAD MELODY CHUNKS  ' ------------------  INPUT #2, CHUNKØCNT  FOR CHUNKØIDX = 0 TO CHUNKØCNT - 1    FOR VIDX=0 TO 5      INPUT #2,V$(VIDX, CHUNKØIDX)    NEXT VIDX  NEXT CHUNKØIDX  INPUT #2,TMPO%    ' LOAD ENVELOPES  ' --------------  FOR ROW = 0 TO 9    INPUT #2, ENVSØNAME$(ROW)    INPUT #2, ENVSØATTACK(ROW)    INPUT #2, ENVSØDECAY(ROW)    INPUT #2, ENVSØSUSTAIN(ROW)    INPUT #2, ENVSØRELEASE(ROW)    INPUT #2, ENVSØWAVEFORM(ROW)    INPUT #2, ENVSØPW(ROW)    GOSUB SETØENV  NEXT ROW  PRINT  ' LOAD FILTER PRESETS  ' -------------------  FOR ROW = 0 TO 10    INPUT #2, FILTØNAME$(ROW)    INPUT #2, FILTØFREQ(ROW)    INPUT #2, FILTØLP(ROW)    INPUT #2, FILTØBP(ROW)    INPUT #2, FILTØHP(ROW)    INPUT #2, FILTØRES(ROW)    INPUT #2, FILTØDIR(ROW)    INPUT #2, FILTØMIN(ROW)    INPUT #2, FILTØSWEEP(ROW)  NEXT ROW  ' LOAD SEQUENCE  ' -------------  SEQCNT = 0  INPUT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    INPUT #2, SEQØCHUNK(ROW)    INPUT #2, SEQØEXTRA(ROW)    ROW = ROW + 1  LOOP  DCLOSE #2  CHUNKØIDX = 0  RETURN.GETØCHUNKØCNT'-------------  CHUNKØCNT = 0  FOR K = 0 TO CHUNKØMAX    IF V$(0,K)<>"" OR V$(1,K)<>"" OR V$(2,K)<>"" OR V$(3,K)<>"" OR V$(4,K)<>"" OR V$(5,K)<>"" THEN BEGIN      CHUNKØCNT = K + 1    BEND  NEXT K  RETURN.SAVE'----  INPUT "SAVE NAME: ";KEY$  IF KEY$="" THEN RETURN    DELETE (KEY$)  DOPEN #2,(KEY$),W,U8  ' SAVE MELODY CHUNKS  ' ------------------  GOSUB GETØCHUNKØCNT  PRINT #2, CHUNKØCNT  FOR CHUNKØIDX = 0 TO CHUNKØCNT - 1    FOR VIDX=0 TO 5      PRINT #2,V$(VIDX, CHUNKØIDX)    NEXT VIDX  NEXT CHUNKØIDX  PRINT #2,TMPO%  ' SAVE ENVELOPES  ' --------------  FOR ROW = 0 TO 9    PRINT #2, ENVSØNAME$(ROW)    PRINT #2, ENVSØATTACK(ROW)    PRINT #2, ENVSØDECAY(ROW)    PRINT #2, ENVSØSUSTAIN(ROW)    PRINT #2, ENVSØRELEASE(ROW)    PRINT #2, ENVSØWAVEFORM(ROW)    PRINT #2, ENVSØPW(ROW)  NEXT ROW  ' SAVE FILTER PRESETS  ' -------------------  FOR ROW = 0 TO 10    PRINT #2, FILTØNAME$(ROW)    PRINT #2, FILTØFREQ(ROW)    PRINT #2, FILTØLP(ROW)    PRINT #2, FILTØBP(ROW)    PRINT #2, FILTØHP(ROW)    PRINT #2, FILTØRES(ROW)    PRINT #2, FILTØDIR(ROW)    PRINT #2, FILTØMIN(ROW)    PRINT #2, FILTØSWEEP(ROW)  NEXT ROW  ' SAVE SEQUENCE  ' -------------  PRINT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    PRINT #2, SEQØCHUNK(ROW)    PRINT #2, SEQØEXTRA(ROW)    ROW = ROW + 1  LOOP  DCLOSE #2  CHUNKØIDX = 0  RETURN.SAVEØASØTEXT'------------  INPUT "SAVE (AS TEXT) NAME: ";KEY$  IF KEY$="" THEN RETURN  DELETE (KEY$)      DOPEN #2,(KEY$),W,U8  FOR CHUNKØIDX = 0 TO CHUNKØMAX    FOR VIDX=0 TO 5      PRINT #2, "V";CHR$(49+VIDX);"$(";STR$(CHUNKØIDX);")=";      PRINT #2, CHR$(34);V$(VIDX, CHUNKØIDX);CHR$(34)    NEXT VIDX      PRINT #2, ""  NEXT CHUNKØIDX  DCLOSE #2  CHUNKØIDX = 0  RETURN.USERØINPUT'----------  ' GETKEY KEY$  GOSUB READØKEYØLOOP  KEY$ = A$  ' DOWN ARROW?  IF KEY$ = À≈ŸØƒœ◊Œ AND CURSORØY<5 THEN BEGIN    CURSORØY = CURSORØY + 1    IF CURSORØX > LEN(V$(CURSORØY,CHUNKØIDX)) THEN CURSORØX = _      LEN(V$(CURSORØY,CHUNKØIDX))  BEND  ' UP ARROW?  IF KEY$ = À≈ŸØ’– AND CURSORØY>0 THEN BEGIN    CURSORØY = CURSORØY - 1    IF CURSORØX > LEN(V$(CURSORØY,CHUNKØIDX)) THEN _      CURSORØX = LEN(V$(CURSORØY,CHUNKØIDX))  BEND  ' RIGHT ARROW?  IF KEY$ = À≈ŸØ“…«»‘ AND CURSORØX < LEN(V$(CURSORØY,CHUNKØIDX)) THEN BEGIN    CURSORØX=CURSORØX+1  BEND  ' LEFT ARROW?  IF KEY$ = À≈ŸØÃ≈∆‘ AND CURSORØX > 0 THEN CURSORØX=CURSORØX-1  ' BACKSPACE (INST/DEL)?  IF KEY$ = À≈ŸØƒ≈Ã AND CURSORØX > 0 THEN BEGIN    V$(CURSORØY,CHUNKØIDX)=LEFT$(V$(CURSORØY,CHUNKØIDX),CURSORØX-1) _      + MID$(V$(CURSORØY,CHUNKØIDX),CURSORØX+1)    CURSORØX=CURSORØX-1  BEND  IF ESCØFLAG% THEN BEGIN    ESCØFLAG%=0    IF KEY$ = "J" THEN BEGIN:CURSORØX=0:BEND    IF KEY$ = "K" THEN BEGIN:CURSORØX=LEN(V$(CURSORØY,CHUNKØIDX)):BEND    KEY$=""  BEND  IF KEY$ = À≈ŸØ≈”√¡–≈ THEN ESCØFLAG%=ABS(ESCØFLAG%-1)  ' CTRL-W = FORWARD ONE WORD  IF KEY$ = À≈ŸØ√‘“ÃØ◊ THEN GOSUB FORWARDØWORD  ' CTRL-U = BACK ONE WORD  IF KEY$ = À≈ŸØ√‘“ÃØ’ THEN GOSUB PREVIOUSØWORD  ' < / > = PREVIOUS/NEXT CHUNK  IF KEY$ = "<" AND CHUNKØIDX>0 THEN BEGIN    CHUNKØIDX=CHUNKØIDX-1    CURSORØX=0  BEND  IF KEY$ = ">" AND CHUNKØIDX<CHUNKØMAX THEN BEGIN    CHUNKØIDX=CHUNKØIDX+1    CURSORØX=0  BEND  ' +/- = TEMPO CHANGE  IF KEY$="-" THEN TMPO%=TMPO%-1  IF KEY$="+" THEN TMPO%=TMPO%+1  ' MEGA-Q = EXIT  IF KEY$ = À≈ŸØÕ≈«¡Ø— THEN BEGIN    PRINT "ARE YOU SURE? (Y/N)"    GET KEY A$    IF A$="Y" THEN KEY ON:END  BEND  IF KEY$ = À≈ŸØ∆1 THEN GOSUB LOAD  IF KEY$ = À≈ŸØ∆3 THEN GOSUB SAVE  IF KEY$ = À≈ŸØ∆7 THEN GOSUB ENVELOPEØEDITOR  IF KEY$ = À≈ŸØ∆9 THEN GOSUB CHUNKØSEQUENCER  ' ∆4 = SAVE AS TEXT  IF KEY$ = À≈ŸØ∆4 THEN GOSUB SAVEØASØTEXT  ' RETURN=PLAY ROW  IF KEY$ = À≈ŸØ“≈‘’“Œ THEN TEMPO TMPO% : PLAY V$(CURSORØY,CHUNKØIDX)  ' SHIFT+RETURN=PLAY ALL CHANNELS  IF KEY$ = À≈ŸØ”»…∆‘Ø“≈‘’“Œ THEN BEGIN    TEMPO TMPO%    GOSUB PLAYØCHUNKØIDX  BEND  GOSUB CHECKØVALIDØKEY  RETURN.PLAYØCHUNKØIDX'--------------  V1$ = V$(0,CHUNKØIDX)  V2$ = V$(1,CHUNKØIDX)  V3$ = V$(2,CHUNKØIDX)  V4$ = V$(3,CHUNKØIDX)  V5$ = V$(4,CHUNKØIDX)  V6$ = V$(5,CHUNKØIDX)  IF ECHOØM = 0 AND ECHOØB = 0 THEN BEGIN    PLAY V1$, V2$, V3$, V4$, V5$, V6$    RETURN  BEND  IF ECHOØM = 1 AND ECHOØB = 0 THEN BEGIN    PLAY V1$, V2$, V3$,    , V5$, V6$    SLEEP (ECHOØSZ)    PLAY    ,    ,    , V1$  BEND  IF ECHOØM = 1 AND ECHOØB = 1 THEN BEGIN    PLAY V1$, V2$, V3$,    , V5$    SLEEP (ECHOØSZ)    PLAY    ,    ,    , V1$,    , V3$  BEND  IF ECHOØM = 2 AND ECHOØB = 0 THEN BEGIN    PLAY V1$,    , V3$,    ,    , V6$    SLEEP (ECHOØSZ)    PLAY    ,    ,    , V1$    SLEEP (ECHOØSZ)    PLAY    , V1$    SLEEP (ECHOØSZ)    PLAY    ,    ,    ,    , V1$  BEND  IF ECHOØM = 2 AND ECHOØB = 1 THEN BEGIN    PLAY V1$,    , V3$    SLEEP (ECHOØSZ)    PLAY    ,    ,    , V1$    SLEEP (ECHOØSZ)    PLAY    , V1$,    ,    ,    , V3$    SLEEP (ECHOØSZ)    PLAY    ,    ,    ,    , V1$  BEND  RETURN.ENVELOPEØEDITOR'---------------  DO WHILE 1    GOSUB DRAWØTABLE    GOSUB GETØUSERØINPUTØFORØTABLE    ' ALT+Q TO EXIT    IF A$ = À≈ŸØÕ≈«¡Ø— THEN EXIT  LOOP  RETURN.DRAWØTABLE'----------  PRINT "ìENV EDITOR";À≈ŸØ‘¡¬;DUR$(SDUR, ƒŒ¡Õ≈);À≈ŸØ‘¡¬;"OCTAVE";OCT  PRINT "----------"  PRINT "-/+: DECR/INCR, “‘Œ: EDIT, ‘¡¬: FOCUS ENV/FILTER, Õ≈«¡+—: EXIT"  PRINT  PRINT "   Œ¡Õ≈";À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;"¡‘‘¡√À";À≈ŸØ‘¡¬;"ƒ≈√¡Ÿ";À≈ŸØ‘¡¬;"”’”‘¡…Œ";À≈ŸØ‘¡¬;"“≈Ã≈¡”≈";À≈ŸØ‘¡¬;  PRINT "◊¡÷≈∆“Õ";À≈ŸØ‘¡¬;"–’Ã”≈◊…ƒ‘»"  FOR ROW = 0 TO 9    IF SROW = ROW THEN PRINT ">";:ELSE PRINT " ";    PRINT ROW;": ";    COL = 0 : V$ = ENVSØNAME$(ROW)    GOSUB SHOWØCELL    COL = 1 : V = ENVSØATTACK(ROW)    GOSUB SHOWØCELL    COL = 2 : V = ENVSØDECAY(ROW)    GOSUB SHOWØCELL    COL = 3 : V = ENVSØSUSTAIN(ROW)    GOSUB SHOWØCELL    COL = 4 : V = ENVSØRELEASE(ROW)    GOSUB SHOWØCELL    COL = 5 : V = ENVSØWAVEFORM(ROW)    GOSUB SHOWØCELL    COL = 6 : V = ENVSØPW(ROW)    GOSUB SHOWØCELL    PRINT  NEXT ROW  PRINT  PRINT "FILTER EDITOR"  PRINT "-------------";  PRINT À≈ŸØ‘¡¬;"FREQ";À≈ŸØ‘¡¬;"LP";À≈ŸØ‘¡¬;"BP";À≈ŸØ‘¡¬;"HP";À≈ŸØ‘¡¬;"RES";  PRINT À≈ŸØ‘¡¬;"DIR";À≈ŸØ‘¡¬;"MIN";À≈ŸØ‘¡¬;"SWEEP"  FOR FPRESET = 0 TO 10    GOSUB SHOWØFILTER  NEXT FPRESET  RETURN.SHOWØFILTER'-----------  IF FSEL = FPRESET THEN PRINT ">";:ELSE PRINT " ";  K = 0 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT FILTØNAME$(FPRESET);"  ";À≈ŸØ‘¡¬;  K = 1 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT FILTØFREQ(FPRESET);À≈ŸØ‘¡¬;  K = 2 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT FILTØSTATEØNAME$(FILTØLP(FPRESET));À≈ŸØ‘¡¬;  K = 3 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT FILTØSTATEØNAME$(FILTØBP(FPRESET));À≈ŸØ‘¡¬;  K = 4 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT FILTØSTATEØNAME$(FILTØHP(FPRESET));À≈ŸØ‘¡¬;  K = 5 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT FILTØRES(FPRESET);À≈ŸØ‘¡¬;  K = 6 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT DIRØNAME$(FILTØDIR(FPRESET));À≈ŸØ‘¡¬;  K = 7 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT FILTØMIN(FPRESET);À≈ŸØ‘¡¬;  K = 8 : GOSUB CHECKØSHOWØFILTERØHIGHLIGHT  PRINT FILTØSWEEP(FPRESET);  PRINT À≈ŸØ“≈÷Øœ∆∆  RETURN.CHECKØSHOWØFILTERØHIGHLIGHT'---------------------------  IF FSROW = FPRESET AND FFOCUS = 1 AND FSCOL = K THEN _    PRINT À≈ŸØ“≈÷ØœŒ; : ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  RETURN.GETØVAL'-------  IF SCOL = 0 THEN V$ = ENVSØNAME$(SROW)  IF SCOL = 1 THEN V = ENVSØATTACK(SROW)  IF SCOL = 2 THEN V = ENVSØDECAY(SROW)  IF SCOL = 3 THEN V = ENVSØSUSTAIN(SROW)  IF SCOL = 4 THEN V = ENVSØRELEASE(SROW)  IF SCOL = 5 THEN V = ENVSØWAVEFORM(SROW)  IF SCOL = 6 THEN V = ENVSØPW(SROW)  RETURN.SHOWØCELL'---------  IF SROW=ROW AND SCOL = COL AND FFOCUS=0 THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  IF COL = 0 THEN BEGIN    PRINT V$;À≈ŸØ‘¡¬;"í";    RETURN  BEND  IF COL = 5 THEN BEGIN    PRINT WNAME$(V);À≈ŸØ‘¡¬;À≈ŸØ“≈÷Øœ∆∆;    RETURN  BEND  ' ELSE  PRINT V;À≈ŸØ‘¡¬;À≈ŸØ“≈÷Øœ∆∆;  RETURN.GETØUSERØINPUTØFORØTABLE'------------------------  ' GET KEY A$  GOSUB READØKEYØLOOP  IF A$ = À≈ŸØÃ≈∆‘ AND SCOL > 0 THEN SCOL = SCOL - 1  IF A$ = À≈ŸØ“…«»‘ AND SCOL < 6 THEN SCOL = SCOL + 1  IF A$ = À≈ŸØ’– AND SROW > 0 THEN SROW = SROW - 1  IF A$ = À≈ŸØƒœ◊Œ AND SROW < 9 THEN SROW = SROW + 1  IF A$ = "+" OR A$="=" THEN DELTA=1 : GOSUB INCRØVAL  IF A$ = "-" THEN DELTA=1 : GOSUB DECRØVAL  IF A$ = À≈ŸØ”»…∆‘Ø–Ã’” THEN DELTA=100 : GOSUB INCRØVAL  IF A$ = À≈ŸØ”»…∆‘ØÕ…Œ’” THEN DELTA=100 : GOSUB DECRØVAL  IF A$ = À≈ŸØ“≈‘’“Œ THEN A$ = "+" : GOSUB EDITØENVØFIELD  IF A$ = À≈ŸØ”»…∆‘Ø“≈‘’“Œ THEN A$ = "-" : GOSUB EDITØENVØFIELD  IF A$ = À≈ŸØ‘¡¬ THEN FFOCUS = 1 : GOSUB GETØUSERØINPUTØFORØFILTERS  GOSUB CHECKØDURATIONØCHANGE  GOSUB CHECKØPIANOØKEYS  RETURN.GETØUSERØINPUTØFORØFILTERS'--------------------------  DO WHILE 1    GOSUB DRAWØTABLE    ' GET KEY A$    GOSUB READØKEYØLOOP    IF A$ = À≈ŸØÃ≈∆‘ AND FSCOL > 0 THEN FSCOL = FSCOL - 1    IF A$ = À≈ŸØ“…«»‘ AND FSCOL < 8 THEN FSCOL = FSCOL + 1    IF A$ = À≈ŸØ’– AND FSROW > 0 THEN FSROW = FSROW - 1    IF A$ = À≈ŸØƒœ◊Œ AND FSROW < 10 THEN FSROW = FSROW + 1    IF A$ = "+" OR A$="=" THEN DELTA=1 : GOSUB INCRØFVAL    IF A$ = "-" THEN DELTA=1 : GOSUB DECRØFVAL    IF A$ = À≈ŸØ”»…∆‘Ø–Ã’” THEN DELTA = 100 : GOSUB INCRØFVAL    IF A$ = À≈ŸØ”»…∆‘ØÕ…Œ’” THEN DELTA = 100 : GOSUB DECRØFVAL    IF A$ = " " THEN BEGIN      IF FSEL = FSROW THEN FSEL = -1:ELSE FSEL = FSROW      GOSUB APPLYØSELECTEDØFILTER    BEND    IF A$ = À≈ŸØ“≈‘’“Œ THEN GOSUB EDITØFILTERØFIELD:GOSUB APPLYØSELECTEDØFILTER    IF A$ = À≈ŸØ‘¡¬ OR A$ = À≈ŸØÕ≈«¡Ø— THEN EXIT    GOSUB CHECKØDURATIONØCHANGE    GOSUB CHECKØPIANOØKEYS  LOOP  FFOCUS = 0  RETURN.READØKEYØLOOP'-------------  A$ = ""  DO WHILE A$=""    GET A$    IF FSEL <> -1 THEN BEGIN      GOSUB UPDATEØSELECTEDØFILTER    BEND    IF PLYFLAG = 1 THEN BEGIN      IF RPLAY(1) = 0 THEN GOSUB PARSEØCURRENTØSEQPTR    BEND  LOOP  RETURN.PARSEØCURRENTØSEQPTR'--------------------  K = SEQØCHUNK(PLYPTR)    IF K >= 0 THEN BEGIN    CHUNKØIDX = K    IF CHUNKØRPT <= 0 THEN CHUNKØRPT = SEQØEXTRA(PLYPTR)    GOSUB PLAYØCHUNKØIDX    SLEEP .1    GOSUB DRAWØSEQUENCE  BEND  IF K = √ÕƒØ‘≈Õ–œ THEN BEGIN    K = SEQØEXTRA(PLYPTR)    TEMPO (K)    TMPO% = K  BEND  IF K = √ÕƒØ∆…Ã‘≈“ THEN BEGIN    K = SEQØEXTRA(PLYPTR)    FSROW = K    FSEL = K    GOSUB APPLYØSELECTEDØFILTER  BEND  IF K = √ÕƒØ≈√»œØÕ1 THEN ECHOØM = 1  IF K = √ÕƒØ≈√»œØÕ2 THEN ECHOØM = 2  IF K = √ÕƒØ≈√»œØ¬  THEN ECHOØB = 1  IF K = √ÕƒØ≈√»œØœ∆∆ THEN ECHOØM = 0 : ECHOØB = 0  IF K = √ÕƒØ≈√»œØ”⁄ THEN ECHOØSZ = SEQØEXTRA(PLYPTR)  IF CHUNKØRPT > 0 THEN CHUNKØRPT = CHUNKØRPT - 1  IF CHUNKØRPT <= 0 THEN PLYPTR = PLYPTR + 1  IF K = √ÕƒØÃœœ– THEN PLYPTR = 0  IF PLYPTR >= SEQCNT THEN PLYFLAG = 0 : PLYPTR = -1  RETURN.CHECKØDURATIONØCHANGE'---------------------  FOR K = ƒØ◊»œÃ≈ TO ƒØ”…ÿ‘≈≈Œ‘»    IF A$ = DUR$(K, ƒÀ≈Ÿ) THEN SDUR = K  NEXT K  ' CHECK OCTAVE TOO  IF A$ = ">" AND OCT < 6 THEN OCT = OCT + 1  IF A$ = "<" AND OCT > 0 THEN OCT = OCT - 1  RETURN.UPDATEØSELECTEDØFILTER'----------------------  IF FSEL = -1 THEN RETURN  IF CURRØDIR = ƒ…“ØŒœŒ≈ THEN RETURN  PRINT "";À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;CHR$(27);"QCURRØFREQ=";CURRØFREQ;    ' Œœ‘≈: √AN'T USE ”≈‘¬…‘ FOR ”…ƒ REGISTERS AS THE REGS ARE WRITE-ONLY  '       (”≈‘¬…‘ WILL INTERNALLY NEED A READ PRIOR TO THE WRITE)  ' ¬’«? … COULDN'T DO –œÀ≈ $ƒ415 (IT BECAME 868691 = $ƒ4153 ?!)  WPOKE 54293, (CURRØFREQ AND 7) + ((CURRØFREQ >> 3) * 256)  WPOKE 54357, (CURRØFREQ AND 7) + ((CURRØFREQ >> 3) * 256)  IF CURRØDIR = ƒ…“Ø’– THEN BEGIN    CURRØFREQ = CURRØFREQ + FILTØSWEEP(FSEL)    IF CURRØFREQ > FILTØFREQ(FSEL) THEN BEGIN      CURRØFREQ = FILTØFREQ(FSEL)      IF FILTØDIR(FSEL) = ƒ…“Øœ”√ THEN CURRØDIR = ƒ…“Øƒœ◊Œ      IF FILTØDIR(FSEL) = ƒ…“Ø’– THEN CURRØFREQ = FILTØMIN(FSEL)    BEND    RETURN  BEND  IF CURRØDIR = ƒ…“Øƒœ◊Œ THEN BEGIN    CURRØFREQ = CURRØFREQ - FILTØSWEEP(FSEL)    IF CURRØFREQ < FILTØMIN(FSEL) THEN BEGIN      CURRØFREQ = FILTØMIN(FSEL)      IF FILTØDIR(FSEL) = ƒ…“Øœ”√ THEN CURRØDIR = ƒ…“Ø’–      IF FILTØDIR(FSEL) = ƒ…“Øƒœ◊Œ THEN CURRØFREQ = FILTØFREQ(FSEL)    BEND    RETURN  BEND  RETURN.APPLYØSELECTEDØFILTER'---------------------  CURRØFREQ = FILTØFREQ(FSROW)  CURRØDIR = ƒ…“ØŒœŒ≈  IF   FILTØDIR(FSROW) = ƒ…“Ø’– _    OR FILTØDIR(FSROW) = ƒ…“Øœ”√ THEN BEGIN    CURRØFREQ = FILTØMIN(FSROW)    CURRØDIR = ƒ…“Ø’–  BEND  IF FILTØDIR(FSROW) = ƒ…“Øƒœ◊Œ THEN BEGIN    CURRØDIR = ƒ…“Øƒœ◊Œ  BEND  FILTER 1, FILTØFREQ(FSROW), FILTØLP(FSROW), _          FILTØBP(FSROW), FILTØHP(FSROW), FILTØRES(FSROW)  FILTER 2, FILTØFREQ(FSROW), FILTØLP(FSROW), _          FILTØBP(FSROW), FILTØHP(FSROW), FILTØRES(FSROW)  RETURN.CHANGEØENVØNAME'---------------  V$=""  INPUT "NEW NAME: ",V$  IF V$<>"" THEN ENVSØNAME$(SROW) = V$  RETURN.EDITØENVØFIELD'--------------  IF SCOL = 0 THEN GOSUB CHANGEØENVØNAME : RETURN  IF SCOL = 6 THEN BEGIN    V$=""    INPUT "NEW VALUE: ",V$    V = VAL(V$)    IF V > 4095 THEN V = 4095    IF V < 0 THEN V = 0    ENVSØPW(SROW) = V    RETURN  BEND  IF A$="+" THEN DELTA=1 : GOSUB INCRØVAL  IF A$="-" THEN DELTA=1 : GOSUB DECRØVAL  RETURN.EDITØFILTERØFIELD'-----------------  IF FSCOL = 2 THEN V=FILTØLP(FSROW):V=MOD(V+1,2):FILTØLP(FSROW)=V:RETURN  IF FSCOL = 3 THEN V=FILTØBP(FSROW):V=MOD(V+1,2):FILTØBP(FSROW)=V:RETURN  IF FSCOL = 4 THEN V=FILTØHP(FSROW):V=MOD(V+1,2):FILTØHP(FSROW)=V:RETURN  IF FSCOL = 6 THEN V=FILTØDIR(FSROW):V=MOD(V+1,4):FILTØDIR(FSROW)=V:RETURN  V$=""  INPUT "NEW VALUE: ",V$  IF V$<>"" THEN BEGIN    IF FSCOL = 0 THEN FILTØNAME$(FSROW) = V$    IF FSCOL = 1 THEN BEGIN      V = VAL(V$)      IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILTØFREQ(FSROW) = V    BEND    IF FSCOL = 5 THEN BEGIN      V = VAL(V$)      IF V > 15 THEN V = 15      IF V < 0 THEN V = 0      FILTØRES(FSROW) = V    BEND    IF FSCOL = 6 THEN BEGIN      V = VAL(V$)      IF V > 3 THEN V = 3      IF V < 0 THEN V = 0      FILTØDIR(FSROW) = V    BEND    IF FSCOL = 7 THEN BEGIN      V = VAL(V$)      IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILTØMIN(FSROW) = V    BEND    IF FSCOL = 8 THEN BEGIN      V = VAL(V$)      IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILTØSWEEP(FSROW) = V    BEND  BEND.CHECKØPIANOØKEYS'----------------  ' APPLY FILTER  PSTR$ = "X0"  IF FSEL <> -1 THEN PSTR$ = "X1"  ' DECIDE NOTE LENGTH  PSTR$ = PSTR$ + DUR$(SDUR, ƒ√»¡“)  ' DECIDE OCTAVE  PSTR$ = PSTR$ + "O" + STR$(OCT)  ' WHICH NOTE TO PLAY  FOR K = 0 TO 11    IF A$ = KEYSØIN$(K) THEN PSTR$ = PSTR$ + KEYSØOUT$(K)  NEXT K  IF LEN(PSTR$)>0 THEN BEGIN    PLAY "T"+STR$(SROW)+PSTR$  BEND  RETURN.INCRØVAL'--------  GOSUB GETØVAL  MAXV = 15  IF SCOL = 5 THEN MAXV = 4  IF SCOL = 6 THEN MAXV = 4095  V = V + DELTA  IF V > MAXV THEN V = MAXV  GOSUB APPLYØVAL  RETURN.DECRØVAL'--------  GOSUB GETØVAL  V = V - DELTA  IF V < 0 THEN V = 0  GOSUB APPLYØVAL  RETURN.INCRØFVAL'---------  IF FSCOL = 1 THEN BEGIN    V = FILTØFREQ(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILTØFREQ(FSROW) = V  BEND  IF FSCOL = 2 THEN FILTØLP(FSROW) = 1  IF FSCOL = 3 THEN FILTØBP(FSROW) = 1  IF FSCOL = 4 THEN FILTØHP(FSROW) = 1  IF FSCOL = 5 THEN BEGIN    V = FILTØRES(FSROW) + DELTA    IF V > 15 THEN V = 15    FILTØRES(FSROW) = V  BEND  IF FSCOL=6 AND FILTØDIR(FSROW) < 3 THEN FILTØDIR(FSROW) = FILTØDIR(FSROW) + 1  IF FSCOL=7 AND FILTØMIN(FSROW) < 2047 THEN BEGIN    V = FILTØMIN(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILTØMIN(FSROW) = V  BEND      IF FSCOL=8 AND FILTØSWEEP(FSROW) < 2047 THEN BEGIN    V = FILTØSWEEP(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILTØSWEEP(FSROW) = V  BEND  GOSUB APPLYØSELECTEDØFILTER  RETURN.DECRØFVAL'---------  IF FSCOL = 1 THEN BEGIN    V = FILTØFREQ(FSROW) - DELTA    IF V < 0 THEN V = 0    FILTØFREQ(FSROW) = V  BEND  IF FSCOL = 2 THEN FILTØLP(FSROW) = 0  IF FSCOL = 3 THEN FILTØBP(FSROW) = 0  IF FSCOL = 4 THEN FILTØHP(FSROW) = 0  IF FSCOL = 5 THEN BEGIN    V = FILTØRES(FSROW) - DELTA    IF V < 0 THEN V = 0    FILTØRES(FSROW) = V  BEND  IF FSCOL=6 AND FILTØDIR(FSROW) > 0 THEN FILTØDIR(FSROW) = FILTØDIR(FSROW) - 1  IF FSCOL=7 AND FILTØMIN(FSROW) > 0 THEN BEGIN    V = FILTØMIN(FSROW) - DELTA    IF V < 0 THEN V = 0    FILTØMIN(FSROW) = V  BEND  IF FSCOL=8 AND FILTØSWEEP(FSROW) > 0 THEN BEGIN    V = FILTØSWEEP(FSROW) - DELTA    IF V < 0 THEN V = 0    FILTØSWEEP(FSROW) = V  BEND  GOSUB APPLYØSELECTEDØFILTER  RETURN.APPLYØVAL'---------  IF SCOL=0 THEN ENVSØNAME$(SROW) = V$  IF SCOL=1 THEN ENVSØATTACK(SROW) = V  IF SCOL=2 THEN ENVSØDECAY(SROW) = V  IF SCOL=3 THEN ENVSØSUSTAIN(SROW) = V  IF SCOL=4 THEN ENVSØRELEASE(SROW) = V  IF SCOL=5 THEN ENVSØWAVEFORM(SROW) = V  IF SCOL=6 THEN ENVSØPW(SROW) = V  ROW = SROW  GOSUB SETØENV  RETURN.SETØENV'-------  ENVELOPE ROW, ENVSØATTACK(ROW), ENVSØDECAY(ROW), ENVSØSUSTAIN(ROW), ENVSØRELEASE(ROW), ENVSØWAVEFORM(ROW), ENVSØPW(ROW)  RETURN.RUNSTOPØTRAPPER'---------------  IF ER=30 THEN RESUME  ' IGNORE RUN/STOP  TRAP  PRINT ERR$(ER);" ERROR"  PRINT " IN LINE";EL  KEY ON  END.CHUNKØSEQUENCER'---------------  DO WHILE 1    GOSUB DRAWØSEQUENCE    GOSUB GETØUSERØINPUTØFORØSEQUENCE    IF A$ = À≈ŸØÕ≈«¡Ø— THEN EXIT  LOOP  RETURN#DECLARE SSCOL, S.DRAWØSEQUENCE'-------------  PRINT "ìSEQUENCE EDITOR"  PRINT "---------------"  PRINT "¡)DD …)NSERT ƒ)ELETE, ≈DIT=“‘Œ, –LAY¡LL=”»∆‘+“‘Œ, –LAY=”–√ - SEQCNT = ";SEQCNT  PRINT "Õ≈«¡+—: EXIT"  PRINT " √MD            ≈XTRA"           PRINT " ---            -----"  K = 0  DO WHILE K < SEQCNT    IF K >= 43 THEN CURSOR 40,5+(K-43)    IF PLYPTR = K THEN PRINT ">";:ELSE PRINT " ";    S=0:GOSUB HIGHLIGHTØSELECTEDØSEQØCOLUMN    ' CHUNK IS A SPECIAL √ÕƒØ*?    IF SEQØCHUNK(K) < 0 AND ABS(SEQØCHUNK(K)) < √ÕƒØÕ¡ÿ THEN BEGIN      V$ = SEQØCMDNAME$(ABS(SEQØCHUNK(K)))      S = 10-LEN(V$)      PRINT V$;      DO WHILE S >= 0        PRINT " ";        S = S - 1      LOOP    BEND:ELSE BEGIN      PRINT SEQØCHUNK(K);À≈ŸØ‘¡¬;    BEND    S=1:GOSUB HIGHLIGHTØSELECTEDØSEQØCOLUMN    HANDLED = 0    IF SEQØCHUNK(K) = √ÕƒØ∆…Ã‘≈“ THEN BEGIN      HANDLED = 1      IF SEQØEXTRA(K) = -1 THEN PRINT À≈ŸØ‘¡¬;"<NONE>":ELSE BEGIN        PRINT À≈ŸØ‘¡¬;FILTØNAME$(SEQØEXTRA(K))      BEND    BEND    IF HANDLED=0 AND SEQØCHUNK(K) = √ÕƒØ‘≈Õ–œ THEN BEGIN      HANDLED = 1      PRINT À≈ŸØ‘¡¬;SEQØEXTRA(K)    BEND    ' ≈Ã”≈    IF HANDLED = 0 THEN BEGIN       PRINT À≈ŸØ‘¡¬;SEQØEXTRA(K)    BEND    PRINT À≈ŸØ“≈÷Øœ∆∆;    K = K + 1  LOOP    RETURN.HIGHLIGHTØSELECTEDØSEQØCOLUMN'-----------------------------  IF SEQPTR = K AND SSCOL=S THEN PRINT À≈ŸØ“≈÷ØœŒ;:ELSE PRINT À≈ŸØ“≈÷Øœ∆∆;  RETURN.GETØUSERØINPUTØFORØSEQUENCE'---------------------------  GOSUB READØKEYØLOOP  IF A$="A" THEN GOSUB ADDØCHUNKØTOØSEQ  IF A$="I" THEN GOSUB INSERTØCHUNKØTOØSEQ  ' IF A$="E" THEN GOSUB EDITØCHUNKØSEQ  IF A$="D" THEN GOSUB DELETEØCHUNKØSEQ  IF A$=À≈ŸØ’– AND SEQPTR > 0 THEN SEQPTR = SEQPTR - 1  IF A$=À≈ŸØƒœ◊Œ AND SEQPTR < SEQCNT-1 THEN SEQPTR = SEQPTR + 1   IF A$=À≈ŸØÃ≈∆‘ AND SSCOL > 0 THEN SSCOL = SSCOL - 1  IF A$=À≈ŸØ“…«»‘ AND SSCOL < 1 THEN SSCOL = SSCOL + 1  IF A$=À≈ŸØ”»…∆‘Ø“≈‘’“Œ THEN BEGIN    PLYPTR = 0    PLYFLAG = 1    CHUNKØRPT = 0    PLAY    GOSUB SETØALLØENV    TEMPO TMPO%  BEND  IF A$=À≈ŸØ”–¡√≈ THEN BEGIN    PLYPTR = SEQPTR    PLYFLAG = 1    CHUNKØRPT = 0    PLAY    GOSUB SETØALLØENV    TEMPO TMPO%  BEND  IF A$=À≈ŸØ“≈‘’“Œ THEN GOSUB EDITØCHUNKØCELL  IF A$=À≈ŸØ≈”√¡–≈ THEN PLYPTR = -1 : PLYFLAG = 0  RETURN.DELETEØCHUNKØSEQ'----------------  IF SEQCNT = 0 THEN RETURN  K = SEQPTR  DO WHILE K < SEQCNT - 1    SEQØCHUNK(K) = SEQØCHUNK(K + 1)    SEQØEXTRA(K) = SEQØEXTRA(K + 1)    K = K + 1  LOOP  SEQCNT = SEQCNT - 1  IF SEQPTR = SEQCNT AND SEQPTR>0 THEN SEQPTR = SEQPTR - 1  RETURN.EDITØCHUNKØSEQ'--------------  IF SEQCNT = 0 THEN RETURN  PRINT À≈ŸØ»œÕ≈;À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;À≈ŸØ≈”√¡–≈;"Q";  V=0:INPUT "CHUNK#: ", V  SEQØCHUNK(SEQPTR) = V  PRINT À≈ŸØ»œÕ≈;À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;À≈ŸØ≈”√¡–≈;"Q";  V=-1:INPUT "EXTRA#: ", V  SEQØEXTRA(SEQPTR) = V  RETURN.EDITØCHUNKØCELL'---------------  IF SEQCNT = 0 THEN RETURN  PRINT À≈ŸØ»œÕ≈;À≈ŸØ‘¡¬;À≈ŸØ‘¡¬;À≈ŸØ≈”√¡–≈;"Q";  IF SSCOL = 0 THEN BEGIN    V = SEQØCHUNK(SEQPTR)    PRINT "CHUNK#: ";À≈ŸØ≈”√¡–≈;"^";V;À≈ŸØ≈”√¡–≈;"_";    INPUT "", V    SEQØCHUNK(SEQPTR) = V  BEND  IF SSCOL = 1 THEN BEGIN    V = SEQØEXTRA(SEQPTR)    PRINT "EXTRA#: ";À≈ŸØ≈”√¡–≈;"^";V;À≈ŸØ≈”√¡–≈;"_";    INPUT "", V    SEQØEXTRA(SEQPTR) = V  BEND  RETURN.INSERTØCHUNKØTOØSEQ'-------------------  SEQCNT = SEQCNT + 1  ' MOVE ALL HIGHER CHUNK SEQUENCES UP ONE  K = SEQCNT - 2  DO WHILE K >= SEQPTR    SEQØCHUNK(K+1) = SEQØCHUNK(K)    SEQØEXTRA(K+1) = SEQØEXTRA(K)    K = K - 1  LOOP  SEQØCHUNK(SEQPTR) = 0  SEQØEXTRA(SEQPTR) = 0  RETURN.ADDØCHUNKØTOØSEQ'----------------  SEQPTR = SEQCNT  SEQCNT = SEQCNT + 1  SEQØCHUNK(SEQPTR) = 0  SEQØEXTRA(SEQPTR) = 0  RETURN